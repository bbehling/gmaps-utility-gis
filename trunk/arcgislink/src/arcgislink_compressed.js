(function(){var D=function(G){var C,U,T;var S=G.split(".");T=window;for(C=0,U=S.length;C<U;C++){T[S[C]]=T[S[C]]||{};T=T[S[C]]}return T};var d=window;var o=D("google.maps");var M=function(S,U,C){var G=(U==="")?0:S.indexOf(U);var T=C===""?S.length:S.indexOf(C,G+U.length);return S.substring(G+U.length,T)};var m=function(C){return typeof C==="string"};var u=function(C){return C&&C.splice};var H=function(T,C,G){if(T&&C){var S;for(S in T){if(G||!(S in C)){C[S]=T[S]}}}return C};var B=function(C,T,G){if(C&&T){if(C.indexOf&&!G){return C.indexOf(T)}else{for(var S=0,U=C.length;S<U;S++){if(C[S]===T||(G===true&&C[S].toString().toLowerCase()===T.toString().toLowerCase())){return S}}}}return -1};var J=function(C,S){for(var G=0,T=S.length;G<T;G++){C.push(S[G])}return C};var q=function(C,S){var G=B(C,S);if(G!==-1){C.splice(G,1)}};var f=function(S,G){if(typeof S[G]!=="undefined"){return S[G]}for(var C in S){if(S.hasOwnProperty(C)){if(G.toLowerCase()===C.toString().toLowerCase()){return S[C]}}}return null};var L=function(S,G,C){if(o.event){o.event.trigger.apply(this,arguments)}};var F=function(G,S){if(G){var C=G.style;if(typeof C.opacity!=="undefined"){C.opacity=S}if(typeof C.filters!=="undefined"){C.filters.alpha.opacity=Math.floor(100*S)}if(typeof C.filter!=="undefined"){C.filter="alpha(opacity:"+Math.floor(S*100)+")"}}};var k=function(C){if(window.console){console.log(C)}};var R=Math.PI/180;var c={};var g=0;window.ags_jsonp=window.ags_jsonp||{};var s=window.ags_jsonp;var r={json:"json",callback:"callback",esriGeometryPoint:"esriGeometryPoint",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryEnvelope:"esriGeometryEnvelope"};c.getJSON=function(C,S,X,V){var G="ags_jsonp"+(g++)+"_"+Math.floor(Math.random()*1000000);var U=C+(C.indexOf("?")===-1?"?":"&");if(S){S.f=S.f||"json";for(var Z in S){if(S.hasOwnProperty(Z)&&S[Z]!==null&&S[Z]!==undefined){U+=(Z+"="+(escape?escape(S[Z]):encodeURIComponent(S[Z]))+"&")}}}var Y=document.getElementsByTagName("head")[0];if(!Y){throw new Error("document must have header tag")}var W=document.createElement("script");W.src=U+X+"=ags_jsonp."+G;W.id=G;var T=function(){delete s[G];Y.removeChild(W);W=null;V.apply(null,arguments);L(c,"jsonpend",G)};s[G]=T;Y.appendChild(W);L(c,"jsonpstart",G);return G};c.fromGeometryToJSON=function(G,U){function T(X){var V=[];for(var W=0,Y=X.length;W<Y;W++){V.push("["+X[W][0]+","+X[W][1]+"]")}return"["+V.join(",")+"]"}function S(W){var V=[];for(var X=0,Y=W.length;X<Y;X++){V.push(T(W[X]))}return"["+V.join(",")+"]"}var C="{";if(G.x){C+="x:"+G.x+",y:"+G.y}else{if(G.xmin){C+="xmin:"+G.xmin+",ymin:"+G.ymin+",xmax:"+G.xmax+",ymax:"+G.ymax}else{if(G.points){C+="points:"+T(G.points)}else{if(G.paths){C+="paths:"+S(G.paths)}else{if(G.rings){C+="rings:"+S(G.rings)}}}}}if(U&&G.spatialReference){if(G.spatialReference.wkid){C+=",spatialReference:{wkid:"+G.spatialReference.wkid+"}"}else{if(G.spatialReference.wkt){C+=",spatialReference:{wkt:"+G.spatialReference.wkt+"}"}}}C+="}";return C};c.groupResultsByLayer=function(Z){var T={};var U,S;var C=Z.results;if(C){for(var G=0,V=C.length;G<V;G++){U=C[G];S=U.layerName;if(!T[S]){var Y={};for(var W in U.attributes){if(U.attributes.hasOwnProperty(W)){Y[W]=W}}var X={displayFieldName:U.displayFieldName,spatialReference:U.geometry?U.geometry.spatialReference:null,geometryType:U.geometryType,fieldAliases:Y,features:[]};T[S]=X}T[S].features.push(U)}}return T};c.getResultSetHtml=function(X,C){var T='<table class="ags-resultset">';var S,G,Y,W;C=C||(X.features.length===1?"v":"h");var U=[];for(var Z in X.fieldAliases){if(X.fieldAliases.hasOwnProperty(Z)){U.push(Z)}}if(C==="h"){T+="<tr>";for(S=0,Y=U.length;S<Y;S++){T+='<th class="ags-fieldname">'+X.fieldAliases[U[S]]+"</th>"}T+="</tr>"}for(S=0,Y=X.features.length;S<Y;S++){var V=X.features[S].attributes;if(C==="h"){T+="<tr>"}else{if(S>0){T+='<tr><td colspan="2"><hr/></td></tr>'}}for(G=0,W=U.length;G<W;G++){if(C==="h"){T+='<td class="ags-fieldvalue">'+V[U[G]]+"</td>"}else{T+='<tr><td class="ags-fieldname">'+X.fieldAliases[U[G]]+'</td><td class="ags-fieldvalue">'+V[U[G]]+"</td></tr>"}}if(C==="h"){T+="</tr>"}}T+="</table>";return T};var j={maxPolyPoints:1000,style:{icon:null,strokeColor:"#FFFF00",strokeWeight:8,strokeOpacity:0.5,outlineColor:"#FF0000",outlineWeight:2,outlineOpacity:0.5,fillColor:"#FFFF00",fillOpacity:0.5}};var b={};function a(C){C=C||{};this.wkid=C.wkid;this.wkt=C.wkt}a.prototype.getKey=function(){return this.wkid?this.wkid:this.wkt?this.wkt:null};a.prototype.forward=function(C){return C};a.prototype.reverse=function(C){return C};a.prototype.getCircumference=function(){return 360};function x(C){C=C||{};a.call(this,C)}x.prototype=new a();function E(C){C=C||{};a.call(this,C);var U=C.inverse_flattening;var X=C.standard_parallel_1*R;var W=C.standard_parallel_2*R;var Y=C.latitude_of_origin*R;this.a_=C.semi_major/C.unit;this.lamdaF_=C.central_meridian*R;this.FE_=C.false_easting;this.FN_=C.false_northing;var T=1/U;var Z=2*T-T*T;this.e_=Math.sqrt(Z);var ab=this.calc_m_(X,Z);var aa=this.calc_m_(W,Z);var V=this.calc_t_(Y,this.e_);var S=this.calc_t_(X,this.e_);var G=this.calc_t_(W,this.e_);this.n_=Math.log(ab/aa)/Math.log(S/G);this.F_=ab/(this.n_*Math.pow(S,this.n_));this.rF_=this.calc_r_(this.a_,this.F_,V,this.n_)}E.prototype=new a();E.prototype.calc_m_=function(G,S){var C=Math.sin(G);return Math.cos(G)/Math.sqrt(1-S*C*C)};E.prototype.calc_t_=function(G,S){var C=S*Math.sin(G);return Math.tan(Math.PI/4-G/2)/Math.pow((1-C)/(1+C),S/2)};E.prototype.calc_r_=function(C,S,G,T){return C*S*Math.pow(G,T)};E.prototype.calc_phi_=function(C,T,S){var G=T*Math.sin(S);return Math.PI/2-2*Math.atan(C*Math.pow((1-G)/(1+G),T/2))};E.prototype.solve_phi_=function(S,U,V){var G=0;var T=V;var C=this.calc_phi_(S,U,T);while(Math.abs(C-T)>1e-9&&G<10){G++;T=C;C=this.calc_phi_(S,U,T)}return C};E.prototype.forward=function(C){var V=C[1]*R;var G=C[0]*R;var T=this.calc_t_(V,this.e_);var U=this.calc_r_(this.a_,this.F_,T,this.n_);var S=this.n_*(G-this.lamdaF_);var W=this.FE_+U*Math.sin(S);var X=this.FN_+this.rF_-U*Math.cos(S);return[W,X]};E.prototype.reverse=function(W){var V=W[0];var X=W[1];var S=Math.atan((V-this.FE_)/(this.rF_-(X-this.FN_)));var G=(this.n_>0?1:-1)*Math.sqrt((V-this.FE_)*(V-this.FE_)+(this.rF_-(X-this.FN_))*(this.rF_-(X-this.FN_)));var T=Math.pow((G/(this.a_*this.F_)),1/this.n_);var U=this.solve_phi_(T,this.e_,0);var C=S/this.n_+this.lamdaF_;return[C/R,U/R]};E.prototype.getCircumference=function(){return Math.PI*2*this.a_};function I(T){T=T||{};a.call(this,T);this.a_=T.semi_major/T.unit;var G=T.inverse_flattening;this.k0_=T.scale_factor;var C=T.latitude_of_origin*R;this.lamdaF_=T.central_meridian*R;this.FE_=T.false_easting;this.FN_=T.false_northing;var S=1/G;this.es_=2*S-S*S;this.ep4_=this.es_*this.es_;this.ep6_=this.ep4_*this.es_;this.eas_=this.es_/(1-this.es_);this.M0_=this.calc_m_(C,this.a_,this.es_,this.ep4_,this.ep6_)}I.prototype=new a();I.prototype.calc_m_=function(G,C,U,T,S){return C*((1-U/4-3*T/64-5*S/256)*G-(3*U/8+3*T/32+45*S/1024)*Math.sin(2*G)+(15*T/256+45*S/1024)*Math.sin(4*G)-(35*S/3072)*Math.sin(6*G))};I.prototype.forward=function(V){var X=V[1]*R;var ab=V[0]*R;var Z=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(X),2));var U=Math.pow(Math.tan(X),2);var G=this.eas_*Math.pow(Math.cos(X),2);var S=(ab-this.lamdaF_)*Math.cos(X);var Y=this.calc_m_(X,this.a_,this.es_,this.ep4_,this.ep6_);var aa=this.FE_+this.k0_*Z*(S+(1-U+G)*Math.pow(S,3)/6+(5-18*U+U*U+72*G-58*this.eas_)*Math.pow(S,5)/120);var W=this.FN_+this.k0_*(Y-this.M0_)+Z*Math.tan(X)*(S*S/2+(5-U+9*G+4*G*G)*Math.pow(S,4)/120+(61-58*U+U*U+600*G-330*this.eas_)*Math.pow(S,6)/720);return[aa,W]};I.prototype.reverse=function(aa){var ad=aa[0];var V=aa[1];var Y=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_));var G=this.M0_+(V-this.FN_)/this.k0_;var ab=G/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256));var Z=ab+(3*Y/2-27*Math.pow(Y,3)/32)*Math.sin(2*ab)+(21*Y*Y/16-55*Math.pow(Y,4)/32)*Math.sin(4*ab)+(151*Math.pow(Y,3)/6)*Math.sin(6*ab)+(1097*Math.pow(Y,4)/512)*Math.sin(8*ab);var T=this.eas_*Math.pow(Math.cos(Z),2);var W=Math.pow(Math.tan(Z),2);var X=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(Z),2));var S=this.a_*(1-this.es_)/Math.pow((1-this.es_*Math.pow(Math.sin(Z),2)),3/2);var C=(ad-this.FE_)/(X*this.k0_);var U=Z-(X*Math.tan(Z)/S)*(C*C/2-(5+3*W+10*T-4*T*T-9*this.eas_)*Math.pow(C,4)/24+(61+90*W+28*T+45*W*W-252*this.eas_-3*T*T)*Math.pow(C,6)/720);var ac=this.lamdaF_+(C-(1+2*W+T)*Math.pow(C,3)/6+(5-2*T+28*W-3*T*T+8*this.eas_+24*W*W)*Math.pow(C,5)/120)/Math.cos(Z);return[ac/R,U/R]};I.prototype.getCircumference=function(){return Math.PI*2*this.a_};function N(C){C=C||{};a.call(this,C);this.a_=(C.semi_major||6378137)/(C.unit||1);this.lamdaF_=(C.central_meridian||0)*R}N.prototype=new a();N.prototype.forward=function(C){var S=C[1]*R;var G=C[0]*R;var T=this.a_*(G-this.lamdaF_);var U=(this.a_/2)*Math.log((1+Math.sin(S))/(1-Math.sin(S)));return[T,U]};N.prototype.reverse=function(T){var S=T[0];var U=T[1];var G=Math.PI/2-2*Math.atan(Math.exp(-U/this.a_));var C=S/this.a_+this.lamdaF_;return[C/R,G/R]};N.prototype.getCircumference=function(){return Math.PI*2*this.a_};function w(C){C=C||{};a.call(this,C);this.lng_=C.latlng.xmin;this.lat_=C.latlng.ymin;this.x_=C.coords.xmin;this.y_=C.coords.ymin;this.xscale_=(C.coords.xmax-C.coords.xmin)/(C.latlng.xmax-C.latlng.xmin);this.yscale_=(C.coords.ymax-C.coords.ymin)/(C.latlng.ymax-C.latlng.ymin)}w.prototype=new a();w.prototype.forward=function(C){var G=this.x_+(C[0]-this.lng_)*this.xscale_;var S=this.y_+(C[1]-this.lat_)*this.yscale_;return[G,S]};w.prototype.reverse=function(G){var C=this.lng_+(G[0]-this.x_)/this.xscale_;var S=this.lat_+(G[1]-this.y_)/this.yscale_;return[C,S]};w.prototype.getCircumference=function(){return this.xscale_*360};var P=new x({wkid:4326});var y=new x({wkid:4269});var A=new N({wkid:102113,semi_major:6378137,central_meridian:0,unit:1});var i=new N({wkid:102100,semi_major:6378137,central_meridian:0,unit:1});b={"4326":P,"4269":y,"102113":A,"102100":i};b.addSpatialReference=function(C,W){var T=this[""+C];if(T){return T}if(W instanceof a){this[""+C]=W;return W}var U=W;var V={wkt:C};if(C===parseInt(C,10)){V={wkid:C}}var S=M(U,'PROJECTION["','"]');var G=M(U,"SPHEROID[","]").split(",");if(S!==""){V.unit=parseFloat(M(M(U,"PROJECTION",""),"UNIT[","]").split(",")[1]);V.semi_major=parseFloat(G[1]);V.inverse_flattening=parseFloat(G[2]);V.latitude_of_origin=parseFloat(M(U,'"Latitude_Of_Origin",',"]"));V.central_meridian=parseFloat(M(U,'"Central_Meridian",',"]"));V.false_easting=parseFloat(M(U,'"False_Easting",',"]"));V.false_northing=parseFloat(M(U,'"False_Northing",',"]"))}switch(S){case"":T=new a(V);break;case"Lambert_Conformal_Conic":V.standard_parallel_1=parseFloat(M(U,'"Standard_Parallel_1",',"]"));V.standard_parallel_2=parseFloat(M(U,'"Standard_Parallel_2",',"]"));T=new E(V);break;case"Transverse_Mercator":V.scale_factor=parseFloat(M(U,'"Scale_Factor",',"]"));T=new I(V);break;default:}if(T){this[""+C]=T}return T};b.getSpatialReference=function(C){return this[""+C]};function v(C){this.url=C;var G=this;c.getJSON(C,{f:r.json},"callback",function(S){H(S,G);L(G,"load")})}function K(C){this.url=C;this.definition=null}K.prototype.isInScale=function(C){if(this.maxScale&&this.maxScale>C){return false}if(this.minScale&&this.minScale<C){return false}return true};K.prototype.query=function(S,G){if(!S){return}var C=H(S,{});C.f=C.f||"json";if(C.geometry&&!m(C.geometry)){C.geometry=c.fromGeometryToJSON(C.geometry)}if(C.geometry){C.spatialRel=C.spatialRel||"esriSpatialRelIntersects"}if(C.outFields&&!m(C.outFields)){C.outFields=C.outFields.join(",")}C.returnGeometry=C.returnGeometry===false?false:true;c.getJSON(this.url+"/query",C,"callback",G)};K.prototype.queryRelatedRecords=function(S,G){if(!S){return}var C=H(S,{});C.f=C.f||"json";if(C.outFields&&!m(C.outFields)){C.outFields=C.outFields.join(",")}C.returnGeometry=C.returnGeometry===false?false:true;c.getJSON(this.url+"/query",C,"callback",G)};function h(C){this.url=C;this.loaded=false;var S=C.split("/");this.name=S[S.length-2].replace(/_/g," ");var G=this;c.getJSON(C,{f:"json"},r.callback,function(T){G.init_(T)})}h.prototype.init_=function(C){var G=this;H(C,this);if(C.spatialReference.wkt){this.spatialReference=b.addSpatialReference(C.spatialReference.wkt,C.spatialReference.wkt)}else{this.spatialReference=b.getSpatialReference(C.spatialReference.wkid)}if(C.tables!==undefined){c.getJSON(this.url+"/layers",{f:r.json},r.callback,function(S){G.initLayers_(S)})}else{this.initLayers_(C)}};h.prototype.initLayers_=function(V){var T=[];var Z=[];var W,U,X,C;for(U=0,X=V.layers.length;U<X;U++){C=V.layers[U];W=new K(this.url+"/"+C.id);H(C,W);W.visible=W.defaultVisibility;T.push(W)}if(V.tables){for(U=0,X=V.tables.length;U<X;U++){C=V.tables[U];W=new K(this.url+"/"+C.id);H(C,W);Z.push(W)}}for(U=0,X=T.length;U<X;U++){W=T[U];if(W.subLayerIds){W.subLayers=[];for(var S=0,Y=W.subLayerIds.length;S<Y;S++){var G=this.getLayer(W.subLayerIds[S]);W.subLayers.push(G);G.parentLayer=W}}}this.layers=T;if(V.tables){this.tables=Z}this.loaded=true;L(this,"load")};h.prototype.getLayer=function(G){var S=this.layers;if(S){for(var C=0,T=S.length;C<T;C++){if(G===S[C].id){return S[C]}if(m(G)&&S[C].name.toLowerCase()===G.toLowerCase()){return S[C]}}}return null};h.prototype.getLayerDefs=function(){var C=null;if(this.layers){for(var S=0,T=this.layers.length;S<T;S++){var G=this.layers[S];if(G.definition){if(C.length>0){C+=";"}C+=String(G.id)+":"+G.definition}}}return C};h.prototype.exportMap=function(C,aa){if(!C||!C.bounds){return}var G=H(C,{});G.f=G.f||"json";var X=G.bounds;G.bbox=""+X.getSouthWest().lng()+","+X.getSouthWest().lat()+","+X.getNorthEast().lng()+","+X.getNorthEast().lat();G.bboxSR="4326";delete G.bounds;if(G.imageSR){if(G.imageSR.wkid){G.imageSR=G.imageSR.wkid}else{G.imageSR="{wkt:"+G.imageSR.wkt+"}"}}G.size=G.size||""+G.width+","+G.height;G.transparent=(G.transparent===false?false:true);var W=[];if(this.layers){var T=false;var V;var U,Y;for(U=0,Y=this.layers.length;U<Y;U++){V=this.layers[U];if(V.subLayers){for(var S=0,Z=V.subLayers.length;S<Z;S++){if(V.subLayers[S].visible===false){V.visible=false;break}}}}for(U=0,Y=this.layers.length;U<Y;U++){V=this.layers[U];if(V.visible!==V.defaultVisibility){T=true}if(V.visible===true){W.push(V.id)}}if(T===true){if(!G.layers||!m(G.layers)){G.layers="show:"+W.join(",")}}if(!G.layerDefs){G.layerDefs=this.getLayerDefs()}}c.getJSON(this.url+"/export",G,"callback",function(ab){ab.bounds=c.fromEnvelopeToLatLngBounds(ab.extent);aa(ab)})};h.prototype.identify=function(G,T){if(!G){return}var S=H(G,{});S.f=S.f||"json";if(!m(S.geometry)){S.geometry=c.fromGeometryToJSON(S.geometry)}var C=S.mapExtent;if(C.xmin){S.mapExtent=""+C.xmin+","+C.ymin+","+C.xmax+","+C.ymax}if(!S.imageDisplay){S.imageDisplay=""+S.width+","+S.height+","+S.dpi}if(S.layers&&!m(S.layers)){S.layers="all:"+this.getLayerIds(S.layers).join(",")}if(!S.layerDefs){S.layerDefs=this.getLayerDefs()}S.returnGeometry=(S.returnGeometry===false?false:true);c.getJSON(this.url+"/identify",S,"callback",T)};h.prototype.find=function(C,S){if(!C){return}var G=H(C,{});G.f=G.f||"json";if(G.layers&&!m(G.layers)){G.layers=this.getLayerIds(G.layers).join(",")}if(G.searchFields&&!m(G.searchFields)){G.searchFields=G.searchFields.join(",")}G.contains=(G.contains===false?false:true);if(!G.layerDefs){G.layerDefs=this.getLayerDefs()}G.returnGeometry=(G.returnGeometry===false?false:true);c.getJSON(this.url+"/find",G,"callback",S)};h.prototype.queryLayer=function(C,S,T){var G=this.getLayer(C);if(G){G.query(S,T)}};function Q(C){this.url=C}Q.prototype.project=function(U,W){if(!U){return}U.f=U.f||"json";if(!m(U.geometries)){var C=r.esriGeometryPoint;var S=[];for(var G=0,V=U.geometries.length;G<V;G++){var T=U.geometries[G];if(G===0){if(T.points){C=r.esriGeometryMultipoint}else{if(T.paths){C=r.esriGeometryPolyline}else{if(T.rings){C=r.esriGeometryPolygon}else{if(T.xmin){C=r.esriGeometryEnvelope}}}}}S.push(c.fromGeometryToJSON(T,false))}U.geometries="{ geometryType:"+C+", geometries:["+S.join(",")+"]}"}c.getJSON(this.url+"/project",U,"callback",W)};function l(C){this.url=C;this.loaded=false;var G=this;c.getJSON(C,{f:"json"},"callback",function(S){G.init_(S)})}l.prototype.init_=function(C){H(C,this);this.loaded=true;L(this,"load")};l.prototype.findAddressCandidates=function(C,S){var G=H(C,{});G.f=G.f||"json";if(G.inputs){H(G.inputs,G);delete G.inputs}if(u(G.outFields)){G.outFields=G.outFields.join(",")}c.getJSON(this.url+"/findAddressCandidates",G,"callback",S)};l.prototype.geocode=function(C,G){this.findAddressCandidates(C,G)};l.prototype.reverseGeocode=function(C,G){C.f=C.f||"json";if(!m(C.location)){C.location=c.fromGeometryToJSON(C.location)}c.getJSON(this.url+"/reverseGeocode",C,"callback",G)};function p(C){if(!C){throw new Error("map service is not tiled")}this.tileInfo_=C;this.spatialReference=b.getSpatialReference(C.spatialReference.wkid||C.spatialReference.wkt);if(!this.spatialReference){throw new Error("unsupported Spatial Reference")}this.resolition0_=this.tileInfo_.lods[0].resolution;this.minZoom=Math.floor(Math.log(this.spatialReference.getCircumference()/this.resolition0_/256)/Math.LN2+0.5);this.maxZoom=this.minZoom+this.tileInfo_.lods.length-1;this.tileSize=new o.Size(this.tileInfo_.cols,this.tileInfo_.rows);this.scale_=Math.pow(2,this.minZoom)*this.resolution0_;this.orginX_=this.tileInfo_.origin.x;this.orginY_=this.tileInfo_.origin.y}p.prototype.fromLatLngToPixel=function(T,G){if(!T||isNaN(T.lat())||isNaN(T.lng())){return null}var S=this.spatialReference.forward([T.lng(),T.lat()]);var C=G||new o.Point(0,0);C.x=(S[0]-this.orginX_)/this.scale_;C.y=(this.originY_-S[1])/this.scale_;return C};p.prototype.fromPixelToLatLng=function(G,U){if(G===null){return null}var C=G.x*this.scale_+this.originX_;var T=this.originY_-G.y*this.scale_;var S=this.spatialReference.inverse([C,T]);return new o.LatLng(S[1],S[0])};p.prototype.getScale=function(G){var S=G-this.minZoom;var C=0;if(this.tileInfo_.lods[S]){C=this.tileInfo_.lods[S].scale}return C};function n(C,T){T=T||{};H(T,this);this.mapService=(C instanceof h)?C:new h(C);if(T.hosts){var V=M(this.mapService.url,"","://");var S=M(this.mapService.url,"://","/");var U=M(this.mapService.url,V+"://"+S,"");this.urlTemplate_=V+"://"+T.hosts+U;this.numOfHosts_=parseInt(M(T.hosts,"[","]"),10)}this.name=this.name||this.mapService.name;this.maxZoom=this.maxZoom||19;if(this.mapService.loaded){this.init_(T)}else{var G=this;o.event.addListenerOnce(this.mapService,"load",function(){G.init_(T)})}}n.prototype.init_=function(C){this.projection=new p(this.mapService.tileInfo);this.minZoom=C.minZoom||this.projection.minZoom;this.maxZoom=C.maxZoom||this.projection.maxZoom};n.prototype.getTileUrl=function(S,G){var T=G-(this.projection?this.projection.minZoom:this.minZoom);if(!isNaN(S.x)&&!isNaN(S.y)&&T>=0&&S.x>=0&&S.y>=0){var C=this.mapService.url;if(this.urlTemplate_){C=this.urlTemplate_.replace("["+this.numOfHosts_+"]",""+((S.y+S.x)%this.numOfHosts_))}return C+"/tile/"+T+"/"+S.y+"/"+S.x}return""};function t(U,T){T=T||{};var C;H(T,this);var S=U;if(m(U)){S=[new n(U)]}else{if(U instanceof n){S=[U]}else{if(U.length>0&&m(U[0])){S=[];for(C=0;C<U.length;C++){S[C]=new n(U[C])}}}}this.tileLayers=S;this.map_=T.map;if(T.maxZoom!==undefined){this.maxZoom=T.maxZoom}else{var G=0;for(C=0;C<S.length;C++){G=Math.max(G,S[C].maxZoom)}this.maxZoom=G}if(S[0].projection){this.tileSize=S[0].projection.tileSize}else{this.tileSize=new o.Size(256,256)}if(!this.name){this.name=S[0].name}}t.prototype.getTile=function(V,W,S){var X=S.createElement("div");for(var U=0;U<this.tileLayers.length;U++){var T=this.tileLayers[U];if(W<=T.maxZoom&&W>=T.minZoom){var G=T.getTileUrl(V,W);if(G){var C=S.createElement("div");C.style.border="0px none";C.style.margin="0px";C.style.padding="0px";C.style.overflow="hidden";C.style.position="absolute";C.style.top="0px";C.style.left="0px";C.style.width=""+this.tileSize.width+"px";C.style.height=""+this.tileSize.height+"px";C.style.backgroundImage="url("+G+")";X.appendChild(C)}}}return X};t.prototype.releaseTile=function(C){};function O(G,C){C=C||{};this.mapService=(G instanceof h)?G:new h(G);this.minZoom=C.minZoom;this.maxZoom=C.maxZoom;this.opacity=C.opacity||1;this.exportParams_=C.exportParams||{};this.drawing_=false;this.needsNewRefresh_=false;this.div_=null;if(C.map){this.setMap(C.map)}}O.prototype=new o.OverlayView();O.prototype.onAdd=function(){var S=document.createElement("div");S.style.position="absolute";S.style.border="none";S.style.position="absolute";this.div_=S;var C=this.getPanes();C.overlayLayer.appendChild(S);var G=this;this.boundsChangedListener_=o.event.addListener(this.getMap(),"bounds_changed",function(){G.refresh()})};O.prototype.onRemove=function(){o.event.removeListener(this.boundsChangedListener_);this.div_.parentNode.removeChild(this.div_);this.div_=null};O.prototype.draw=function(){if(!this.drawing_||this.needsNewRefresh_===true){this.refresh()}};O.prototype.getOpacity=function(){return this.opacity_};O.prototype.refresh=function(){if(this.drawing_===true){this.needsNewRefresh_=true;return}var C=this.getMap();var W=C?C.getBounds():null;if(!W){return}var V=this.exportParams_;V.bounds=W;var T=A;var S=C.getDiv();V.size=""+S.offsetWidth+","+S.offsetHeight;var G=C.getProjection();if(G&&G instanceof p){T=G.spatialReference}V.imageSR=T;o.event.trigger(this,"drawstart");var U=this;this.drawing_=true;this.div_.style.backgroundImage="";this.mapService.exportMap(V,function(Z){U.drawing_=false;if(U.needsNewRefresh_===true){U.needsNewRefresh_=false;U.refresh();return}if(Z.href){var Y=U.getProjection();var aa=Z.bounds;var X=Y.fromLatLngToDivPixel(aa.getSouthWest());var ab=Y.fromLatLngToDivPixel(aa.getNorthEast());var ac=U.div_;ac.style.left=X.x+"px";ac.style.top=ab.y+"px";ac.style.width=(ab.x-X.x)+"px";ac.style.height=(X.y-ab.y)+"px";U.div_.style.backgroundImage="url("+Z.href+")";U.setOpacity(U.opacity_)}o.event.trigger(U,"drawend")})};O.prototype.getFullBounds=function(){this.fullBounds_=this.fullBounds_||c.fromEnvelopeToLatLngBounds(this.mapService_.fullExtent);return this.fullBounds_};O.prototype.getInitialBounds=function(){this.initialBounds_=this.initialBounds_||c.fromEnvelopeToLatLngBounds(this.mapService_.initialExtent);return this.initialBounds_};O.prototype.setOpacity=function(G){var S=Math.min(Math.max(G,0),1);this.opacity_=S;var C=this.img_;F(C,S)};O.prototype.isHidden=function(){return !(this.visible_&&this.isInZoomRange_())};O.prototype.isInZoomRange_=function(){var C=this.getMap().getZoom();if((this.minZoom!==undefined&&C<this.minZoom)||(this.maxZoom!==undefined&&C>this.maxZoom)){return false}return true};O.prototype.show=function(){this.visible_=true;this.div_.style.visibility="visible";this.refresh()};O.prototype.hide=function(){this.visible_=false;this.div_.style.visibility="hidden"};c.fromEnvelopeToLatLngBounds=function(S){var G=b.getSpatialReference(S.spatialReference.wkid||S.spatialReference.wkt);G=G||P;var C=G.reverse([S.xmin,S.ymin]);var T=G.reverse([S.xmax,S.ymax]);return new o.LatLngBounds(new o.LatLng(C[1],C[0]),new o.LatLng(T[1],T[0]))};c.fromLatLngBoundsToEnvelope=function(T,G){var C=G.forward([T.getSouthWest().lng(),T.getSouthWest().lat()]);var S=G.forward([T.getNorthEast().lng(),T.getNorthEast().lat()]);return{xmin:C[0],ymin:C[1],xmax:S[0],ymax:S[1],spatialReference:{wkid:G.wkid}}};c.fromPointToLatLng=function(C,T){var G=C.spatialReference||T;var S=G?b.getSpatialReference(G.wkid):P;S=S||P;if(isNaN(C.x)||isNaN(C.y)){return null}var U=S.reverse([C.x,C.y]);return new GLatLng(U[1],U[0])};c.fromLatLngToPoint=function(T,G){var C=null;if(G){C=(G instanceof a)?G:b.getSpatialReference(G.wkid)}C=C||P;var S=C.forward([T.lng(),T.lat()]);return{x:S[0],y:S[1],spatialReference:{wkid:C.wkid}}};c.fromFeatureToOverlays=function(S,T,C,ag){var G=[];var ab=null;var U;var Z=S.geometry;if(T){if(T instanceof a){ab=T}else{ab=b.getSpatialReference(T.wkid)}}else{ab=b.getSpatialReference(Z.spatialReference.wkid)}if(ab===null){return G}var af=C||{};var V,ae,X,ac,ai,Y,aa,ad,ah;var aj="";if(ag){aj=S.attributes[ag]}var W="<table>";for(V in S.attributes){if(S.attributes.hasOwnProperty(V)){W+='<tr><td class="ags-fieldname">'+V+'</td><td class="ags-fieldvalue">'+S.attributes[V]+"</td></tr>"}}W+="</table>";if(Z.x){ad=ab.reverse([Z.x,Z.y]);U=new GMarker(new GLatLng(ad[1],ad[0]),{icon:af.icon,title:aj});U.attributes=S.attributes;U.html=W;G.push(U)}else{Y=Z.points||Z.paths||Z.rings;if(!Y){return G}for(ae=0,X=Y.length;ae<X;ae++){aa=Y[ae];if(Z.points){ad=ab.reverse(aa);U=new o.Marker(new GLatLng(ad[1],ad[0]),{icon:af.icon})}else{if(aa.length>1000){continue}ah=[];for(ac=0,ai=aa.length;ac<ai;ac++){ad=ab.reverse(aa[ac]);ah.push(new o.LatLng(ad[1],ad[0]))}if(Z.paths){U=new o.Polyline(ah,af.strokeColor,af.strokeWeight,af.strokeOpacity)}else{if(Z.rings){U=new o.Polygon(ah,af.outlineColor,af.outlineWeight,af.outlineOpacity,af.fillColor,af.fillOpacity)}}}U.attributes=S.attributes;U.html=W;G.push(U)}}return G};var e={SpatialReference:a,Geographic:x,LambertConformalConic:E,SphereMercator:N,TransverseMercator:I,FlatSpatialReference:w,SpatialReferences:b,Catalog:v,MapService:h,Layer:K,GeocodeService:l,GeometryService:Q,Util:c,Config:j,Projection:p,TileLayer:n,MapOverlay:O,MapType:t};var z=D("gmaputils");z.ags=e})();