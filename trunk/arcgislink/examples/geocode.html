<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <title>Geocode</title>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript">
            document.write('<script type="text/javascript" src="../src/arcgislink' + (document.location.search.indexOf('packed') > -1 ? '_packed' : document.location.search.indexOf('compiled') > -1 ? '_compiled' : document.location.search.indexOf('compressed') > -1 ? '_compressed' : '') + '.js"><' + '/script>');
        </script>
        <script type="text/javascript">
            var map, geocoder, iw;
            function init() {
              var myOptions = {
                zoom: 4,
                center: new google.maps.LatLng(40, -100),
                mapTypeId: google.maps.MapTypeId.ROADMAP
              }
              map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
              geocoder = new gmaps.ags.GeocodeService('http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Locators/ESRI_Geocode_USA/GeocodeServer');
              iw = new google.maps.InfoWindow({
                maxWidth: 180
              });
              geocode();
            }
            
            function geocode() {
              geocoder.findAddressCandidates({
                inputs: {
                  Address: '380 new york st',
                  State: 'CA',
                  City: 'redlands',
                  Zip: '92373'
                }
              }, function(results) {
                var markers = [];
                if (results.candidates) {
                  for (var i = 0, c = results.candidates.length; i < c; i++) {
                    var marker = createMarker(results.candidates[i]);
                    marker.setMap(map);
                    markers.push(marker);
                    if (i == 0) {
                      map.setCenter(marker.getPosition());
                      map.setZoom(15);
                      google.maps.event.trigger(marker, 'click');
                    }
                  }
                }
              });
            }
            
            function createMarker(gc) {
              var html = 'Matched Address:' + gc.address + '<br/>' +
              'Score:' +
              gc.score +
              '<br/>';
              if (gc.attributes) {
                var attrs = gc.attributes;
                for (var x in attrs) {
                  if (attrs.hasOwnProperty(x)) {
                    html += x + attrs[x] + '<br/>';
                  }
                }
              }
              var latlng = gc.location;
              var marker = new google.maps.Marker({
                title: gc.address,
                position: latlng
              });
              google.maps.event.addListener(marker, 'click', function() {
                iw.setContent(html);
                iw.setPosition(latlng);
                iw.open(map);
              });
              return marker;
            }
        </script>
    </head>
    <body style="margin:0px; padding:0px;" onload="init()">
        <div id="map_canvas" style="width:100%; height:100%">
        </div>
    </body>
</html>
