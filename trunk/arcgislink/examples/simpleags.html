<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>Simple AGS</title>
        <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript">
        </script>
        <script type="text/javascript">
            document.write('<script type="text/javascript" src="../src/arcgislink' + (document.location.search.indexOf('packed') > -1 ? '_packed' : '') + '.js"><' + '/script>');
        </script>
        <script type="text/javascript">
            var ov;
            function init() {
              var myOptions = {
                zoom: 4,
                center: new google.maps.LatLng(40, -100),
                mapTypeId: google.maps.MapTypeId.ROADMAP
              }
              var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
              var url = 'http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StateCityHighway_USA/MapServer';
              ov = new ArcGISMapOverlay(url, {
                opacity: 0.5
              });
              google.maps.event.addListener(ov, 'load', function() {
                ov.addToMap(map);
                var service = ov.getMapService();
                var toc = '';
                var layers = service.getLayers();
                for (var i = 0; i < layers.length; i++) {
                  toc += '<input type="checkbox" id="layer' + layers[i].id + '"';
                  if (layers[i].visible) 
                    toc += ' checked="checked"';
                  toc += ' onclick="setVis()">' + layers[i].name + '<br/>';
                }
                document.getElementById('toc').innerHTML = toc;
              });
              
             
            }
            
            function setVis() {
              var service = ov.getMapService();
              var layers = service.getLayers();
              for (var i = 0; i < layers.length; i++) {
                var el = document.getElementById('layer' + layers[i].id);
                layers[i].visible = (el.checked === true);
              }
              ov.refresh();
            }
        </script>
    </head>
    <body onload="init()">
        <a href='../docs/examples.html'>More examples</a>
        | Use<a href='?packed'>Packed </a>
        | <a href='?'>Unpacked</a>
        Version of the script.
        <br/>
        <br/>
        Use Check box to turn on/off layers in a dynamic map service.
        <table>
            <tr>
                <td valign="top">
                    <div id="toc" style="width:130px;">
                    </div>
                </td>
                <td>
                    <div id="map_canvas" style="width:800px; height:400px; border:1px solid #000;">
                    </div>
                </td>
            </tr>
        </table>
    </body>
</html>
