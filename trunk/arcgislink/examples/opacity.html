<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <title>Opacity</title>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript">
         document.write('<script type="text/javascript" src="../src/arcgislink'+(document.location.search.indexOf('packed')>-1?'_packed':document.location.search.indexOf('compiled')>-1?'_compiled':document.location.search.indexOf('compressed')>-1?'_compressed':'')+'.js"><'+'/script>');
        </script>
        
        <script type="text/javascript" src='http://google-maps-utility-library-v3.googlecode.com/svn/tags/extdraggableobject/1.0/src/ExtDraggableObject.js'>
        </script>
        
        <script type="text/javascript">
        function init() {
          var myOptions = {
            zoom: 17,
            center: new google.maps.LatLng(45.5, -122.7),
            mapTypeId: google.maps.MapTypeId.HYBRID,
            streetViewControl: true //my favorite feature in V3!
          }
          var opacity = 0.5;
          var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
          var url = 'http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Portland/ESRI_LandBase_WebMercator/MapServer';
          var agsType = new gmaputils.ags.MapType(url, {
            name: 'ArcGIS',
            opacity: opacity
          });
          map.overlayMapTypes.insertAt(0, agsType);
          
          var slideContainer = document.getElementById('slideContainer');
          var slideBar = document.getElementById("slideBar");
          map.controls[google.maps.ControlPosition.TOP].push(slideContainer);
          var opacSlider = new ExtDraggableObject(slideBar, {
            restrictY: true,
            container: slideContainer
          });
          var range = (parseInt(slideContainer.style.width)-parseInt(slideBar.style.width));
          opacSlider.setValueX(range * opacity)
          google.maps.event.addListener(opacSlider, 'drag', function(evt){
             var op = opacSlider.left()/range;
             agsType.setOpacity(op);
             document.getElementById('op').innerHTML = parseInt(op * 100);
          });
        }
        </script>
    </head>
   <body style="margin:0px; padding:0px;" onload="init()">
        <div id="map_canvas" style="width:100%; height:100%">
        </div>
        <div id="slideContainer" style="margin-top:20px; width:210px;height:20px;background-color:yellow;color:#AAAAAA;border-style:inset;">Drag knob to change.(<span id='op'></span>%)<div id="slideBar" style="top:0px;width:8px;height:20px;background-color:blue;" title='Drag me!'>&nbsp;</div>
        </div>
    </body>
</html>
