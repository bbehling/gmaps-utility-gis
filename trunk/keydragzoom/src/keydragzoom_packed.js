(function(){var f=null;var g=null;var s=null;var r=null;var y=null;var k=null;var l=null;var t=null;var v=null;var w=null;var q=null;var u=false;var n=false;var z=null;var m=null;var o=null;var j,boxMaxY;var i=null;function getBorderWidths(h){var b;var a={};if(document.defaultView&&document.defaultView.getComputedStyle){b=h.ownerDocument.defaultView.getComputedStyle(h,"");if(b){a.top=parseInt(b.borderTopWidth,10)||0;a.bottom=parseInt(b.borderBottomWidth,10)||0;a.left=parseInt(b.borderLeftWidth,10)||0;a.right=parseInt(b.borderRightWidth,10)||0;return a}}else if(document.documentElement.currentStyle){if(h.currentStyle){a.top=parseInt(toPixels(h.currentStyle.borderTopWidth),10)||0;a.bottom=parseInt(toPixels(h.currentStyle.borderBottomWidth),10)||0;a.left=parseInt(toPixels(h.currentStyle.borderLeftWidth),10)||0;a.right=parseInt(toPixels(h.currentStyle.borderRightWidth),10)||0;return a}}a.top=parseInt(h.style["border-top-width"],10)||0;a.bottom=parseInt(h.style["border-bottom-width"],10)||0;a.left=parseInt(h.style["border-left-width"],10)||0;a.right=parseInt(h.style["border-right-width"],10)||0;return a}function toPixels(a){var b;switch(a){case'thin':b="2px";break;case'medium':b="4px";break;case'thick':b="6px";break;default:b=a}return b}function getMousePosition(e){var a=0,posY=0;e=e||window.event;if(typeof e.pageX!=="undefined"){a=e.pageX;posY=e.pageY}else if(typeof e.clientX!=="undefined"){a=e.clientX+(typeof document.documentElement.scrollLeft!=="undefined"?document.documentElement.scrollLeft:document.body.scrollLeft);posY=e.clientY+(typeof document.documentElement.scrollTop!=="undefined"?document.documentElement.scrollTop:document.body.scrollTop)}return{left:a,top:posY}}function getElementPosition(h){var a=h.offsetLeft;var b=h.offsetTop;var c=h.offsetParent;while(c!==null){if(c!==document.body&&c!==document.documentElement){a-=c.scrollLeft;b-=c.scrollTop}a+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}return{left:a,top:b}}function drawBox(){if(i&&z&&m){var b=i.fromLatLngToContainerPixel(z);var a=i.fromLatLngToContainerPixel(m);w.style.left=Math.min(b.x,a.x)+'px';w.style.top=Math.min(b.y,a.y)+'px';w.style.width=Math.abs(b.x-a.x)+'px';w.style.height=Math.abs(b.y-a.y)+'px';w.style.display='block'}}function zoomBox(){if(i&&z&&m){var d=new GLatLng(Math.min(z.lat(),m.lat()),Math.min(z.lng(),m.lng()));var c=new GLatLng(Math.max(z.lat(),m.lat()),Math.max(z.lng(),m.lng()));var a=new GLatLngBounds(d,c);var b=i.getBoundsZoomLevel(a);i.setCenter(a.getCenter(),b)}}function isHotKeyDown(e){var a;e=e||window.event;a=(e.shiftKey&&f==='shift')||(e.altKey&&f==='alt')||(e.ctrlKey&&f==='ctrl');if(!a){switch(e.keyCode){case 16:if(f==='shift'){a=true}break;case 17:if(f==='ctrl'){a=true}break;case 18:if(f==='alt'){a=true}break}}return a}function onKeyDown(e){if(i&&!u&&isHotKeyDown(e)){u=true;var a=i.getSize();q.style.left=0+'px';q.style.top=0+'px';q.style.width=a.width-(t.left+t.right)+'px';q.style.height=a.height-(t.top+t.bottom)+'px';q.style.display='block';j=parseInt(q.style.width,10)-(v.left+v.right);boxMaxY=parseInt(q.style.height,10)-(v.top+v.bottom)}}function onMouseDown(e){if(i&&u){z=m=null;o=getElementPosition(i.getContainer());n=true}}function onMouseMove(e){if(n){var b=getMousePosition(e);var p=new GPoint();p.x=b.left-o.left-t.left;p.y=b.top-o.top-t.top;p.x=Math.min(p.x,j);p.y=Math.min(p.y,boxMaxY);p.x=Math.max(p.x,0);p.y=Math.max(p.y,0);var a=i.fromContainerPixelToLatLng(p);if(!z){z=a}m=a;drawBox()}}function onMouseUp(e){if(n){zoomBox();n=false}w.style.display='none'}function onKeyUp(e){if(i&&u){u=false;n=false;w.style.display='none';q.style.display="none"}}function setVals(a,b){if(a&&b){for(var x in b){if(b.hasOwnProperty(x)){a[x]=b[x]}}}return a}function setOpacity(a,b){if(typeof b!=='undefined'){a.style.opacity=b}if(typeof a.style.opacity!=='undefined'){a.style.filter="alpha(opacity="+(a.style.opacity*100)+")"}}GMap2.prototype.enableKeyDragZoom=function(a){i=this;a=a||{};f=a.key||'shift';f=f.toLowerCase();g=a.callbacks||{};t=getBorderWidths(i.getContainer());q=document.createElement("div");q.onselectstart=function(){return false};setVals(q.style,{backgroundColor:'white',opacity:0.0,cursor:'crosshair'});setVals(q.style,a.paneStyle);setVals(q.style,{position:'absolute',overflow:'hidden',zIndex:101,display:'none'});if(f=='shift'){q.style.MozUserSelect="none"}setOpacity(q);if(q.style.backgroundColor==='transparent'){q.style.backgroundColor='white';setOpacity(q,0)}i.getContainer().appendChild(q);w=document.createElement('div');setVals(w.style,{border:'thin solid #FF0000'});setVals(w.style,a.boxStyle);setVals(w.style,{position:'absolute',display:'none'});setOpacity(w);i.getContainer().appendChild(w);v=getBorderWidths(w);r=GEvent.addDomListener(document,'keydown',onKeyDown);s=GEvent.addDomListener(document,'keyup',onKeyUp);y=GEvent.addDomListener(q,'mousedown',onMouseDown);k=GEvent.addDomListener(document,'mousemove',onMouseMove);l=GEvent.addDomListener(document,'mouseup',onMouseUp)};GMap2.prototype.disableKeyDragZoom=function(){if(i){GEvent.removeListener(y);GEvent.removeListener(k);GEvent.removeListener(l);GEvent.removeListener(s);GEvent.removeListener(r);i.getContainer().removeChild(w);i.getContainer().removeChild(q);i=null}};GMap2.prototype.keyDragZoomEnabled=function(){return i!==null}})();