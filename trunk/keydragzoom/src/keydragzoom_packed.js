(function(){var z=function(a){var b;switch(a){case'thin':b="2px";break;case'medium':b="4px";break;case'thick':b="6px";break;default:b=a}return b};var y=function(h){var b;var a={};if(document.defaultView&&document.defaultView.getComputedStyle){b=h.ownerDocument.defaultView.getComputedStyle(h,"");if(b){a.top=parseInt(b.borderTopWidth,10)||0;a.bottom=parseInt(b.borderBottomWidth,10)||0;a.left=parseInt(b.borderLeftWidth,10)||0;a.right=parseInt(b.borderRightWidth,10)||0;return a}}else if(document.documentElement.currentStyle){if(h.currentStyle){a.top=parseInt(z(h.currentStyle.borderTopWidth),10)||0;a.bottom=parseInt(z(h.currentStyle.borderBottomWidth),10)||0;a.left=parseInt(z(h.currentStyle.borderLeftWidth),10)||0;a.right=parseInt(z(h.currentStyle.borderRightWidth),10)||0;return a}}a.top=parseInt(h.style["border-top-width"],10)||0;a.bottom=parseInt(h.style["border-bottom-width"],10)||0;a.left=parseInt(h.style["border-left-width"],10)||0;a.right=parseInt(h.style["border-right-width"],10)||0;return a};var o=function(e){var a=0,posY=0;e=e||window.event;if(typeof e.pageX!=="undefined"){a=e.pageX;posY=e.pageY}else if(typeof e.clientX!=="undefined"){a=e.clientX+(typeof document.documentElement.scrollLeft!=="undefined"?document.documentElement.scrollLeft:document.body.scrollLeft);posY=e.clientY+(typeof document.documentElement.scrollTop!=="undefined"?document.documentElement.scrollTop:document.body.scrollTop)}return{left:a,top:posY}};var l=function(h){var a=h.offsetLeft;var b=h.offsetTop;var c=h.offsetParent;while(c!==null){if(c!==document.body&&c!==document.documentElement){a-=c.scrollLeft;b-=c.scrollTop}a+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}return{left:a,top:b}};var n=function(a,b){if(a&&b){for(var x in b){if(b.hasOwnProperty(x)){a[x]=b[x]}}}return a};var m=function(a,b){if(typeof b!=='undefined'){a.style.opacity=b}if(typeof a.style.opacity!=='undefined'){a.style.filter="alpha(opacity="+(a.style.opacity*100)+")"}};function DragZoom(a){}var f=null;var v=null;var u=null;var C=null;var j=null;var k=null;var w=null;var B=null;var D=null;var t=null;var A=false;var q=false;var E=null;var r=null;var s=null;var i,boxMaxY;var g=null;function drawBox(){if(g&&E&&r){var b=g.fromLatLngToContainerPixel(E);var a=g.fromLatLngToContainerPixel(r);D.style.left=Math.min(b.x,a.x)+'px';D.style.top=Math.min(b.y,a.y)+'px';D.style.width=Math.abs(b.x-a.x)+'px';D.style.height=Math.abs(b.y-a.y)+'px';D.style.display='block'}}function zoomBox(){if(g&&E&&r){var d=new GLatLng(Math.min(E.lat(),r.lat()),Math.min(E.lng(),r.lng()));var c=new GLatLng(Math.max(E.lat(),r.lat()),Math.max(E.lng(),r.lng()));var a=new GLatLngBounds(d,c);var b=g.getBoundsZoomLevel(a);g.setCenter(a.getCenter(),b)}}function isHotKeyDown(e){var a;e=e||window.event;a=(e.shiftKey&&f==='shift')||(e.altKey&&f==='alt')||(e.ctrlKey&&f==='ctrl');if(!a){switch(e.keyCode){case 16:if(f==='shift'){a=true}break;case 17:if(f==='ctrl'){a=true}break;case 18:if(f==='alt'){a=true}break}}return a}function onKeyDown(e){if(g&&!A&&isHotKeyDown(e)){A=true;var a=g.getSize();t.style.left=0+'px';t.style.top=0+'px';t.style.width=a.width-(w.left+w.right)+'px';t.style.height=a.height-(w.top+w.bottom)+'px';t.style.display='block';i=parseInt(t.style.width,10)-(B.left+B.right);boxMaxY=parseInt(t.style.height,10)-(B.top+B.bottom)}}function onMouseDown(e){if(g&&A){E=r=null;s=l(g.getContainer());q=true}}function onMouseMove(e){if(q){var b=o(e);var p=new GPoint();p.x=b.left-s.left-w.left;p.y=b.top-s.top-w.top;p.x=Math.min(p.x,i);p.y=Math.min(p.y,boxMaxY);p.x=Math.max(p.x,0);p.y=Math.max(p.y,0);var a=g.fromContainerPixelToLatLng(p);if(!E){E=a}r=a;drawBox()}}function onMouseUp(e){if(q){zoomBox();q=false}D.style.display='none'}function onKeyUp(e){if(g&&A){A=false;q=false;D.style.display='none';t.style.display="none"}}GMap2.prototype.enableKeyDragZoom=function(a){g=this;a=a||{};f=a.key||'shift';f=f.toLowerCase();w=y(g.getContainer());t=document.createElement("div");t.onselectstart=function(){return false};n(t.style,{backgroundColor:'white',opacity:0.0,cursor:'crosshair'});n(t.style,a.paneStyle);n(t.style,{position:'absolute',overflow:'hidden',zIndex:101,display:'none'});if(f==='shift'){t.style.MozUserSelect="none"}m(t);if(t.style.backgroundColor==='transparent'){t.style.backgroundColor='white';m(t,0)}g.getContainer().appendChild(t);D=document.createElement('div');n(D.style,{border:'thin solid #FF0000'});n(D.style,a.boxStyle);n(D.style,{position:'absolute',display:'none'});m(D);g.getContainer().appendChild(D);B=y(D);u=GEvent.addDomListener(document,'keydown',onKeyDown);v=GEvent.addDomListener(document,'keyup',onKeyUp);C=GEvent.addDomListener(t,'mousedown',onMouseDown);j=GEvent.addDomListener(document,'mousemove',onMouseMove);k=GEvent.addDomListener(document,'mouseup',onMouseUp)};GMap2.prototype.disableKeyDragZoom=function(){if(g){GEvent.removeListener(C);GEvent.removeListener(j);GEvent.removeListener(k);GEvent.removeListener(v);GEvent.removeListener(u);g.getContainer().removeChild(D);g.getContainer().removeChild(t);g=null}};GMap2.prototype.keyDragZoomEnabled=function(){return g!==null}})();